jQuery(function($){$("#adv_price").on("contextmenu",function(e){return false});$("#adv_price").on("keypress",function(e){var key=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if($.inArray(e.key,["0","1","2","3","4","5","6","7","8","9",",","."])!==-1){return true}else if(e.ctrlKey||e.shiftKey){return false}else if($.inArray(key,[8,35,36,37,39,46])!==-1){return true}return false});$('.post-type-adv_zone form[name="post"] [name="post_title"]').attr("required",true);$('.post-type-adv_package form[name="post"] [name="post_title"]').attr("required",true);$('.post-type-adv_campaign form[name="post"] [name="post_title"]').attr("required",true);$('.post-type-adv_ad form[name="post"] [name="post_title"]').attr("required",true);var $page=jQuery(".advertising_page_adv-settings");jQuery(".toplevel_page_adv li.wp-first-item a").html(adv_admin_params.txt_dashboard);jQuery(".toplevel_page_adv li.wp-first-item").hide();jQuery("a.toplevel_page_adv").attr("href",adv_admin_params.dashboard_href);jQuery("#adv-tabs",$page).find("a").click(function(){var $wrap=jQuery(this).closest(".wrap");jQuery("#adv-tabs",$wrap).find("a").removeClass("nav-tab-active");jQuery(".adv-tab",$wrap).removeClass("active");var id=jQuery(this).attr("id").replace("-tab","");jQuery("#"+id,$wrap).addClass("active");jQuery(this).addClass("nav-tab-active")});var active_tab=window.location.hash.replace("#top#","");if(active_tab==""||active_tab=="#_=_"||!active_tab){active_tab=jQuery(".adv-tab",$page).attr("id")}jQuery("#"+active_tab,$page).addClass("active");jQuery("#"+active_tab+"-tab",$page).addClass("nav-tab-active");jQuery(".nav-tab-active",$page).click();adv_set_tab_hashes();$("#adv_package #adv_type").on("change",function(e){e.preventDefault();var mBox=$(this).closest(".inside");if($(this).val()=="cpp"){$(".adv-row-terms",mBox).addClass("adv-none");$(".adv-row-cpp",mBox).removeClass("adv-none")}else{$(".adv-row-cpp",mBox).addClass("adv-none");$(".adv-row-terms",mBox).removeClass("adv-none")}var terms_txt=$(this).find("option:selected").data("terms")?$(this).find("option:selected").data("terms"):"";$(".adv-terms-text",mBox).text(terms_txt)});$("#adv_package #adv_type").trigger("change");$("#post_type_to").on("change",function(e){e.preventDefault();var $this=$(this);var $selection=$this.closest("td").find(".adv-check-boxes");if($this.find("option:selected").data("select")){if(!$selection.is(":visible")){$selection.slideDown("fast")}}else{if($selection.is(":visible")){$selection.slideUp("fast")}}});$("#post_type_to").trigger("change");$("#user_role_to").on("change",function(e){e.preventDefault();var $this=$(this);var $selection=$this.closest("td").find(".adv-check-boxes");if($this.find("option:selected").data("select")){if(!$selection.is(":visible")){$selection.slideDown("fast")}}else{if($selection.is(":visible")){$selection.slideUp("fast")}}});$("#user_role_to").trigger("change");$("#taxonomy_to").on("change",function(e){e.preventDefault();var $this=$(this);var $selection=$this.closest("td").find(".adv-check-boxes");if($this.find("option:selected").data("select")){if(!$selection.is(":visible")){$selection.slideDown("fast")}}else{if($selection.is(":visible")){$selection.slideUp("fast")}}});$("#taxonomy_to").trigger("change");$("#post_to").on("change",function(e){e.preventDefault();var $this=$(this);var $selection=$this.closest("td").find(".adv-check-boxes");if($this.find("option:selected").data("select")){if(!$selection.is(":visible")){$selection.slideDown("fast")}}else{if($selection.is(":visible")){$selection.slideUp("fast")}}});$("#post_to").trigger("change");$("#term_to").on("change",function(e){e.preventDefault();var $this=$(this);var $selection=$this.closest("td").find(".adv-check-boxes");if($this.find("option:selected").data("select")){if(!$selection.is(":visible")){$selection.slideDown("fast")}}else{if($selection.is(":visible")){$selection.slideUp("fast")}}});$("#term_to").trigger("change");$(".adv-mbtab-panel #packages_to").on("change",function(e){$val=$("#packages_to").val();if($val=="show"||$val=="hide"){$(this).closest("td").find(".adv-check-boxes").show()}else{$(this).closest("td").find(".adv-check-boxes").hide()}});$("#adv-ad-details #adv_type").on("change",function(e){e.preventDefault();var val=$(this).val();$("#adv-ad-details .adv-none").hide();$("#adv-ad-details .adv-show-"+val).show()});$("#adv-ad-details #adv_type").trigger("change");$(".adv-media-upload .btn").on("click",function(e){e.preventDefault();var input=$(this).siblings(".regular-text");var image=wp.media({title:adv_admin_params.upload_image,multiple:false}).open().on("select",function(e){$(input).val(image.state().get("selection").first().attributes.url).trigger("change")})});$(".adv-media-upload .regular-text").on("change",function(e){var src=$(this).val();$(".adv-media-upload .img-fluid").attr("src",src);if(src){$(".adv-media-upload .img-fluid").show()}else{$(".adv-media-upload .img-fluid").hide()}})});function adv_set_tab_hashes(){jQuery("#adv-tabs").find("a").each(function(){var id=jQuery(this).attr("id").replace("-tab","");var optiontab=jQuery("#"+id);var form=optiontab.children(".adv-settings-tab-main-form");if(form.length){var currentUrl=form.attr("action").split("#")[0];form.attr("action",currentUrl+jQuery(this).attr("href"))}})}jQuery(function($){$(".adv-mbtabs .nav-link").on("click",function(e){e.preventDefault();var $li=$(this).parent(),panel=$li.data("panel"),$wrapper=$li.closest(".adv-mbtabs"),$panel=$wrapper.find(".adv-mbtab-panel-"+panel);$wrapper.find(".adv-mbtab-active").removeClass("adv-mbtab-active, active");$(this).addClass("adv-mbtab-active active");$panel.show().siblings().hide()});$(".adv-mbtab-nav .nav-link").first().trigger("click");$(".adv-mbtabs-no-wrapper").closest(".postbox").addClass("adv-mbtabs-no-controls");$("#adv_link_to_packages").on("change",function(){$("#adv-zone-details").toggleClass("linked-to-geodirectory",$("#adv_link_to_packages").is(":checked"));$("#adv_price_row_warning").toggleClass("d-none",!$("#adv_link_to_packages").is(":checked"));$("#adv_price_row").toggleClass("d-none",$("#adv_link_to_packages").is(":checked"));$("#adv_advertise_here_url, #adv_advertisement_link_wrapper").toggleClass("d-none",$("#adv_link_to_packages").is(":checked"))});$("#adv_link_to_packages").trigger("change");if($(".adv-row-gd_post_types").length){$("#advertising_allowed_ad_types").on("change",function(){var aVal=$(this).val();if(typeof aVal==="object"&&aVal.length&&!Object.values(aVal).includes("listing")){$(".adv-row-gd_post_types").addClass("d-none")}else{$(".adv-row-gd_post_types").removeClass("d-none")}});$("#advertising_allowed_ad_types").trigger("change")}$("#adv_grid").on("change",function(){$("#adv-zone-details").toggleClass("displaying-as-grid",$("#adv_grid").is(":checked"))});$("#adv_grid").trigger("change");$(".gpa-select-listing:not(.enhanced)").each(function(){var $el=$(this);var select2Args={allowClear:$(this).data("allow-clear")||$(this).data("allow_clear")?true:false,placeholder:$(this).data("placeholder"),minimumInputLength:$(this).data("min-input-length")?$(this).data("min-input-length"):3,ajax:{url:adv_admin_params.ajax_url,type:"POST",dataType:"json",delay:250,data:function(params){var data={action:"advertising_listings",isAdmin:true,search:params.term,adv_zone:$el.closest("form").length&&$el.closest("form").find('[name="zone"]').length?parseInt($el.closest("form").find('[name="zone"]').val()):0,_ajax_nonce:adv_admin_params.ajax_nonce};return data},processResults:function(res){if(res.success){return{results:res.data}}return{results:[]}}},templateResult:function(item){if(item.loading){return adv_admin_params.searching}if(!item.id){return item.text}return jQuery("<span>"+item.text+"</span>")},language:{inputTooShort:function(){return adv_params.search_listings}}};if(typeof aui_select2_locale=="function"){select2Args=$.extend(select2Args,aui_select2_locale())}var $select2=$(this).select2(select2Args);$select2.addClass("enhanced adv-all-listings-shown").removeClass("aui-select2")})});